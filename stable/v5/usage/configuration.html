<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title> | Fellow Oak DICOM 5 API </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content=" | Fellow Oak DICOM 5 API ">
      
      
      <link rel="icon" href="../images/favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/fo-dicom/fo-dicom/blob/development/Documentation/v5/usage/configuration.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/logo.svg" alt="Fellow Oak DICOM">
            Fellow Oak DICOM
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">

<p>There are 3 classes of various options that configure the behavior of fo-dicom.
In <code>DicomClientOptions</code> there are the properties to configure the <code>DicomClient</code>, with <code>DicomServerOptions</code> the behavior of the <code>DicomServer</code> is configured, and <code>DicomServiceOptions</code> is used in both for the behavior of the underlying network service.</p>
<p><em>fo-dicom</em> uses the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-9.0">Options pattern</a>. The configuration and the default values for them are registered as options in the DI-container. Whenever an instance of DicomClient or DicomServer is created, the current values of the options are loaded from DI and copied to the instance. The values for the instance are then not changed any more to avoid inconsistencies.
The current values for an instance can be accessed via the Options-properties.</p>
<p>The values of the options can be changed in several places</p>
<h3 id="directly-change-the-options-of-an-instance">Directly change the options of an instance</h3>
<p>After an instance of a DicomClient or a DicomServer is created, the settings of these instances can be changed, before they start their network connections.
These settings only affect the instance where the values are changed.</p>
<pre><code class="lang-csharp">var client = clientFactory.Create(&quot;localhost&quot;, 104, false, &quot;TEST&quot;, &quot;SERVER&quot;);
// now change the values of the options as required
client.ClientOptions.MaximumNumberOfRequestsPerAssociation = 1;
client.ServiceOptions.MaxPDULength = 64000;

//...
await client.SendAsync();
</code></pre>
<pre><code class="lang-csharp">using var server = serverFactory.Create&lt;DicomCEchoProvider&gt;(port);
// change the options of the DicomServer
server.Options.UseRemoteAEForLogName = true;
</code></pre>
<h3 id="passing-configure-actions-to-factories-or-to-setup">Passing configure-actions to factories or to setup</h3>
<p>As described in the options pattern, fo-dicom accepts configuration functions as paraemters in factories or at startup of the application. These configuration actions are then always executed and change the default values of the registered options classes.</p>
<pre><code class="lang-csharp">using var server = serverFactory.Create&lt;DicomCEchoProvider&gt;(port, configure: o =&gt; o.MaxClientsAllowed = 1);
</code></pre>
<pre><code class="lang-csharp">new DicomSetupBuilder()
    .RegisterServices(s =&gt; s.AddFellowOakDicom(
        configureServiceOptions: o =&gt;
        {
            o.LogDataPDUs = true;
            o.LogDimseDatasets = true;
        },
        configureClientOptions: o =&gt;
        {
            o.AssociationRequestTimeoutInMs = 5000;
            o.AssociationReleaseTimeoutInMs = 1000;
        }))
    .Build();
</code></pre>
<h3 id="binding-to-iconfiguration">Binding to IConfiguration</h3>
<p>Many applications already are using IConfiguration to handle configuration. The values then can be changed at runtime via appsettings.json files or environment variables, or any other registered provider.</p>
<p>On Startup, a section of the IConfiguration can be passed as argument. <em>fo-dicom</em> then tries to extract the values from that section. It is assumed, that all the values are located in sub-sections, where the name of the section has to match the class name and the name of the value has to match the property name.
The name of the section where <em>fo-dicom</em> searches for the value can be choosen freely. It is also possible to pass the whole Configuration as parameter, but it is not recommended.</p>
<p>Consider the following code snippet, where on application startup the section <code>FellowOakDicom</code> of the IConfiguration is bound to the options.</p>
<pre><code class="lang-csharp">public class Startup
{
    // .. configuration is initialized 

    public IConfiguration Configuration { get; }

    public void ConfigureServices(IServiceCollection services)
    {
        services.AddFellowOakDicom(Configuration.GetSecion(&quot;FellowOakDicom&quot;));
        //...
    }

}
</code></pre>
<p>Then later at runtime, if you want to change some properties of DicomServiceOptions and DicomClientOptions, then add the following to your appsettings.json</p>
<pre><code class="lang-json">{
  FellowOakDicom: {
     DicomServiceOptions: {
       MaxPDULength: 512000
     },
     DicomClientOptions: {
       ConnectionTimeoutInMs: 2000
     }
  }
}
</code></pre>
<p>or add the following values to your environment variables:</p>
<pre><code>FellowOakDicom__DicomServiceOptions__MaxPDULength=512000
FellowOakDicom__DicomClientOptions__ConnectionTimeoutInMs=2000
</code></pre>
<h3 id="priority-of-evaluation">Priority of evaluation</h3>
<ol>
<li>By default <em>fo-dicom</em> ships the options with some default values that are applied if no other configuration is set.</li>
<li>Then if some Configuration is bound to the options, then these values overrule the built-in default values.</li>
<li>Any configuration method that is passed as parameter in factories or at startup then overrides the values read from Configuration</li>
<li>Changing the properties of a created instance directly has the highest priority and will be used in any case and not changed by any other configuration mechanism.</li>
</ol>

</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright (c) 2012-2025 fo-dicom contributors
        </div>
      </div>
    </footer>
  </body>
</html>
